{"version":3,"sources":["webpack:///webpack/bootstrap f2be000b272777c33bf7","webpack:///./development/js/correspondence.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","QarrEmailModal","QarrReplyToFeedback","QarrReplyModal","Garnish","Base","extend","$btn","$btnText","$spinner","$waveLoaderContainer","$waveLoader","type","entryId","modal","wavifyOptions","height","bones","amplitude","color","speed","init","el","this","$","data","find","parent","addListener","openEmailModal","e","preventDefault","on","proxy","sendEmail","_this","that","email","subject","message","addClass","removeClass","wavify","Craft","postActionRequest","response","textStatus","velocity","css","background-color","kill","emailSent","hide","opacity","pointer-events","html","t","Modal","widget","self","body","base","$form","appendTo","$bod","setContainer","join","show","$cancelBtn","$subjectInput","$messageInput","QarrInputField","QarrTextareaField","setTimeout","focus","save","$subject","val","$message","subjectLabel","messageLabel","trigger","$responseContainer","$replyTextarea","reply","placeholder","replyId","elementId","authorId","openReplyModal","updateReply","_this2","id","updateFeedbackHtml","_this3","success","template","cp","displayNotice"],"mappings":"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","file":"/release/src/web/assets/js/correspondence.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 39);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f2be000b272777c33bf7","let QarrEmailCorrespondence, QarrEmailModal, QarrReplyToFeedback, QarrReplyModal;\n\nQarrEmailCorrespondence = Garnish.Base.extend({\n    $btn: null,\n    $btnText: null,\n    $spinner: null,\n    $waveLoaderContainer: null,\n    $waveLoader: null,\n\n    type: null,\n    entryId: null,\n    modal: null,\n\n    wavifyOptions: {\n        height: 20,\n        bones: 3,\n        amplitude: 40,\n        color: '#B289EF',\n        speed: .45\n    },\n\n    init(el) {\n        this.$btn = $(el)\n        this.entryId = $(el).data('entry-id')\n        this.type = $(el).data('type')\n        this.$btnText = this.$btn.find('.link-text')\n        this.$spinner = this.$btn.find('.spinner')\n        this.$waveLoaderContainer = this.$btn.parent().parent().find('.loader-container')\n        this.$waveLoader = this.$waveLoaderContainer.find('.wave-loader')\n\n        this.addListener(this.$btn, 'click', 'openEmailModal')\n    },\n\n    openEmailModal(e) {\n        e.preventDefault()\n\n        if (this.modal) {\n            delete this.modal\n            this.modal = new QarrEmailModal(this)\n        } else {\n            this.modal = new QarrEmailModal(this)\n        }\n\n        this.modal.on('save', $.proxy(this, 'sendEmail'))\n    },\n\n    sendEmail(data) {\n        let that = this\n        let email = data.email\n\n        data = {\n            type: this.type,\n            entryId: this.entryId,\n            subject: email.subject,\n            message: email.message,\n        }\n\n        this.$btnText.addClass('hide')\n        this.$spinner.removeClass('hidden');\n\n        this.$waveLoader = $('.wave-loader').wavify(this.wavifyOptions)\n\n        Craft.postActionRequest('qarr/correspondence/send-mail', data, $.proxy(((response, textStatus) => {\n            if (textStatus === 'success') {\n                this.$waveLoaderContainer.velocity({height: '150%'}, 2000, function () {\n                    that.$waveLoaderContainer.css({'height': '100%', 'background-color': '#B289EF'})\n                    that.$waveLoader.kill()\n                })\n\n                this.emailSent()\n            }\n        }), this))\n\n        this.modal.hide()\n    },\n\n    emailSent() {\n        let that = this\n\n        this.$waveLoaderContainer.velocity({opacity: 0}, 'fast', function () {\n            that.$waveLoaderContainer.css({'pointer-events': 'none'})\n            that.$btn.parent().html('<span class=\"mail-result\">' + Craft.t('qarr', 'Mail sent!') + '</span>')\n        })\n    }\n\n\n})\n\nQarrEmailModal = Garnish.Modal.extend({\n    widget: null,\n\n    init(widget) {\n        let body, self\n        self = this\n        this.base()\n\n        this.widget = widget\n\n        this.$form = $('<form class=\"modal fitted qarr-modal prompt-modal modal-blue\">').appendTo(Garnish.$bod)\n        this.setContainer(this.$form)\n\n        // TODO: Make From Name dynamic to use site admin name\n        // TODO: Make subject use entry title\n\n        body = $([\n            '<div class=\"body\">',\n            '<header class=\"header\">',\n            '<span class=\"header-text\">' + Craft.t('qarr', 'Sending Email') + '</span>',\n            '<span class=\"icon\"><i class=\"fa fa-mail-bulk\"></i></span>',\n            '</header>',\n            '<div class=\"qarr-field custom-field field-white-bg\">',\n            '<input class=\"text fullwidth\" type=\"text\" id=\"reply-subject\" name=\"reply-subject\" autocomplete=\"off\">',\n            '<label id=\"reply-subject-label\" for=\"reply-subject\" data-label=\"' + Craft.t('qarr', 'Subject') + '\" data-error-message=\"' + Craft.t('qarr', 'Subject cannot be blank.') + '\">' + Craft.t('qarr', 'Subject') + '</label>',\n            '<span class=\"qarr-error-icon\"><i class=\"fa fa-exclamation-triangle\"></i></span>',\n            '</div>',\n            '<div class=\"qarr-field custom-field field-white-bg\">',\n            '<textarea id=\"reply-message\" rows=\"6\"></textarea>',\n            '<label id=\"reply-message-label\" for=\"reply-message\" data-label=\"' + Craft.t('qarr', 'Message') + '\" data-error-message=\"' + Craft.t('qarr', 'Message cannot be blank.') + '\">' + Craft.t('qarr', 'Message') + '</label>',\n            '<span class=\"qarr-error-icon\"><i class=\"fa fa-exclamation-triangle\"></i></span>',\n            '</div>',\n            '<div class=\"buttons\">',\n            '<input type=\"button\" class=\"btn btn-modal cancel\" value=\"' + Craft.t('qarr', 'Cancel') + '\">',\n            '<input type=\"submit\" class=\"btn btn-modal submit\" value=\"' + Craft.t('qarr', 'Send') + '\">',\n            '</div>',\n            '</div>'].join('')).appendTo(this.$form)\n\n        this.show();\n\n        this.$cancelBtn = body.find('.cancel')\n\n        this.$subjectInput = body.find('#reply-subject')\n        this.$messageInput = body.find('#reply-message')\n\n        new QarrInputField(this.$subjectInput.parent())\n        new QarrTextareaField(this.$messageInput.parent())\n\n        setTimeout($.proxy(function () {\n            self.$subjectInput.focus()\n        }, this), 100);\n\n        this.addListener(this.$cancelBtn, 'click', 'hide')\n        this.addListener(this.$form, 'submit', 'save')\n    },\n\n    save(e) {\n        e.preventDefault()\n        this.$subject = this.$subjectInput.val()\n        this.$message = this.$messageInput.val()\n\n        let subjectLabel = this.$subjectInput.parent().find('label')\n        let messageLabel = this.$messageInput.parent().find('label')\n\n        this.email = {\n            subject: this.$subject,\n            message: this.$message\n        }\n\n        this.$subjectInput.removeClass('has-error')\n        this.$messageInput.removeClass('has-error')\n\n        if (this.$subjectInput.val() === '' && this.$messageInput.val() === '') {\n            // Garnish.shake(this.$container)\n\n            if (this.$subjectInput.val() === '') {\n                this.$subjectInput.parent().addClass('has-error')\n                subjectLabel.html(subjectLabel.data('error-message'))\n            }\n\n            if (this.$messageInput.val() === '') {\n                this.$messageInput.parent().addClass('has-error')\n                messageLabel.html(messageLabel.data('error-message'))\n            }\n        } else {\n            this.trigger('save', {\n                email: this.email\n            })\n\n        }\n    }\n})\n\nQarrReplyToFeedback = Garnish.Base.extend({\n    $btn: null,\n    $responseContainer: null,\n    $replyTextarea: null,\n    $spinner: null,\n\n    modal: null,\n    reply: null,\n    placeholder: null,\n    type: null,\n    replyId: null,\n    elementId: null,\n    authorId: null,\n\n    init(el) {\n        this.$btn = $(el)\n        this.$responseContainer = $('.panel-response')\n        this.$spinner = $('.panel-response .spinner')\n        this.type = this.$btn.data('type')\n        this.elementId = this.$btn.data('element-id')\n        this.authorId = this.$btn.data('author-id')\n        this.replyId = this.$btn.data('reply-id')\n        this.placeholder = this.$btn.data('placeholder')\n\n        this.addListener(this.$btn, 'click', 'openReplyModal')\n    },\n\n\n    openReplyModal(e) {\n        e.preventDefault()\n\n        if (this.modal) {\n            delete this.modal\n            this.modal = new QarrReplyModal(this)\n        } else {\n            this.modal = new QarrReplyModal(this)\n        }\n\n        this.modal.on('save', $.proxy(this, 'updateReply'))\n    },\n\n    updateReply(data) {\n        this.$spinner.removeClass('hidden');\n        this.$responseContainer.find('.response-container').addClass('faded')\n\n        data = {\n            id: this.replyId,\n            reply: this.reply,\n            elementId: this.elementId,\n            authorId: this.authorId,\n        }\n\n        Craft.postActionRequest('qarr/replies/save', data, $.proxy(((response, textStatus) => {\n            if (textStatus === 'success') {\n                $('.feedback-panel').addClass('has-response')\n                this.updateFeedbackHtml(response.response)\n            }\n        }), this))\n\n        this.modal.hide()\n    },\n\n    updateFeedbackHtml(data) {\n        let that = this\n\n        Craft.postActionRequest('qarr/replies/get-markup', data, $.proxy(((response, textStatus) => {\n            if (response.success) {\n                setTimeout($.proxy(function () {\n                    this.$responseContainer.html(response.template);\n                    Craft.cp.displayNotice(Craft.t('qarr', 'Reply added'))\n                    this.$spinner.addClass('hidden')\n                    this.$responseContainer.find('.response-container').removeClass('faded')\n                    new QarrReplyToFeedback('#reply-to-feedback-btn')\n                    this.$btn.velocity({opacity: 0}, 500, function () {\n                        that.$btn.hide()\n                    })\n                }, this), 1000);\n            }\n        }), this))\n    }\n})\n\nQarrReplyModal = Garnish.Modal.extend({\n    widget: null,\n\n    init(widget) {\n        let body, self\n        self = this\n        this.base()\n        this.widget = widget\n\n        this.$form = $('<form class=\"modal fitted qarr-modal prompt-modal\">').appendTo(Garnish.$bod)\n        this.setContainer(this.$form)\n\n        body = $([\n            '<div class=\"body\">',\n            '<header class=\"header\">',\n            '<span class=\"header-text\">' + Craft.t('qarr', 'Reply to Feedback') + '</span>',\n            '<span class=\"icon\"><i class=\"fa fa-reply\"></i></span>',\n            '</header>',\n            '<div class=\"qarr-field custom-field field-white-bg\">',\n            '<textarea id=\"reply-text\" rows=\"6\"></textarea>',\n            '<label id=\"reply-text-label\" for=\"reply-text\" data-label=\"' + Craft.t('qarr', 'Reply Message') + '\" data-error-message=\"' + Craft.t('qarr', 'Reply Message cannot be blank.') + '\">' + Craft.t('qarr', 'Reply Message') + '</label>',\n            '<span class=\"qarr-error-icon\"><i class=\"fa fa-exclamation-triangle\"></i></span>',\n            '</div>',\n            '<div class=\"buttons\">',\n            '<input type=\"button\" class=\"btn btn-modal cancel\" value=\"' + Craft.t('qarr', 'Cancel') + '\">',\n            '<input type=\"submit\" class=\"btn btn-modal submit\" value=\"' + Craft.t('qarr', 'Add') + '\">',\n            '</div>',\n            '</div>'].join('')).appendTo(this.$form)\n\n        this.show();\n        this.$cancelBtn = body.find('.cancel')\n        this.$replyTextarea = body.find('#reply-text')\n\n\n        new QarrTextareaField(this.$replyTextarea.parent())\n\n        if (this.widget.placeholder) {\n            this.$replyTextarea.val(this.widget.placeholder)\n        }\n\n        setTimeout($.proxy(function () {\n            self.$replyTextarea.focus()\n        }, this), 100);\n\n        this.addListener(this.$cancelBtn, 'click', 'hide')\n        this.addListener(this.$form, 'submit', 'save')\n    },\n\n    save(e) {\n        e.preventDefault()\n        this.reply = this.$replyTextarea.val()\n        this.widget.reply = this.reply\n\n        let messageLabel = this.$replyTextarea.parent().find('label')\n\n        if (this.reply === '') {\n            // Garnish.shake(this.$container)\n\n            if (this.$replyTextarea.val() === '') {\n                this.$replyTextarea.parent().addClass('has-error')\n                messageLabel.html(messageLabel.data('error-message'))\n            }\n        } else {\n            this.trigger('save', {\n                reply: this.reply\n            })\n        }\n    }\n});\n\n\n// WEBPACK FOOTER //\n// ./development/js/correspondence.js"],"sourceRoot":""}