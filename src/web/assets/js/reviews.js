Garnish.$doc.ready(function(){$(".flagged-rules").length>0&&tippy(".tippy-with-html",{onShow:function(e){var t=e.id,a=document.getElementById("flag-template-"+t).cloneNode(!0);$(a).show(),e.setContent(a)},placement:"right",interactive:!0,theme:"light",duration:400,arrow:!0,arrowType:"sharp",multiple:!0}),$("#reply-email-btn").length>0&&new QarrEmailCorrespondence("#reply-email-btn"),$("#reply-to-feedback-btn").length>0&&new QarrReplyToFeedback("#reply-to-feedback-btn"),$(".abuse-reported-meta .btns").on("click",function(e){e.preventDefault();var t={id:$(this).data("entry-id"),type:$(this).data("type")};Craft.postActionRequest("qarr/elements/clear-abuse",t,$.proxy(function(e,t){e.success&&(Craft.cp.displayNotice(Craft.t("qarr","Abuse cleared")),$(".abuse-reported-meta").velocity({opacity:0},500,function(){$(".abuse-reported-meta").remove()}))},this))}),$(".update-status-btn").on("click",function(e){e.preventDefault();var t={id:$(this).data("element-id"),status:$(this).data("status"),type:$(this).data("type")};Craft.postActionRequest("qarr/elements/update-status",t,$.proxy(function(e,t){e.success&&(Craft.cp.displayNotice(Craft.t("qarr","Status updated")),"approved"===e.entry.status&&($(".status-badge").removeClass("status-pending"),$(".status-badge").removeClass("status-rejected")),"rejected"===e.entry.status&&($(".status-badge").removeClass("status-pending"),$(".status-badge").removeClass("status-approved")),$(".status-badge").addClass("status-"+e.entry.status),$(".status-badge").find("span").html(e.entry.status))},this))}),$(".feedback-panel #delete-feedback-btn").on("click",function(e){e.preventDefault();var t={id:$(this).data("reply-id")};Craft.postActionRequest("qarr/replies/delete",t,$.proxy(function(e,t){e.success&&(Craft.cp.displayNotice(Craft.t("qarr","Reply deleted")),$(".panel-response").remove(),$(".feedback-panel").removeClass("has-response"),$("#reply-to-feedback-btn").show())},this))}),$(".delete-entry").on("click",function(e){e.preventDefault();var t={id:$(this).data("element-id"),type:$(this).data("type")},a=Craft.t("qarr","Deleting this review will also remove all its responses and correspondence?");new QarrPrompt(a,null).on("response",function(e){var a=this;"ok"===e.response&&Craft.postActionRequest("qarr/reviews/delete",t,$.proxy(function(e,t){e.success&&setTimeout($.proxy(function(){Craft.cp.displayNotice(Craft.t("qarr","Entry deleted, redirecting...")),setTimeout($.proxy(function(){Craft.redirectTo(Craft.getCpUrl()+"/qarr/reviews")},this),1e3)},a),1e3)},this))})})});
