var DirectLink=Garnish.Base.extend({$container:null,$elementSelectContainer:null,$generatedUrlInput:null,type:null,elementType:null,siteUrl:null,user:null,element:null,selectedClass:null,init:function(e){var t=this;this.$container=$(e),this.type=this.$container.data("type"),this.elementType=this.$container.data("element-type"),this.siteUrl=this.$container.data("site-url")+"qarr/direct?",this.$elementSelectContainer=this.$container.find(".elementselect"),this.$generatedUrlInput=this.$container.find("#generated-url"),this.handleSelectedElements(),this.on("elementRemoved",function(e){var n=e.settings.elementType;"craft\\elements\\Entry"===n&&(t.element=null),"craft\\elements\\User"===n&&(t.user=null),t.$generatedUrlInput.val(t.siteUrl)})},handleSelectedElements:function(){var e=this,t=this.$container.find(".element");$.each(t,function(t,n){var l=$(n)[0],i=l.dataset.id,s=l.dataset.type;"craft\\elements\\Entry"===s&&(e.element={id:i,type:"Entry"}),"craft\\elements\\User"===s&&(e.user={id:i,type:"User"})})},handleAddElement:function(e){var t=this;Craft.postActionRequest("qarr/campaigns/direct-links/get-element-info",{elementId:e.id},$.proxy(function(e,n){e.success&&t.buildUrl(e)},this))},handleRemoveElement:function(){},buildUrl:function(e){this.selectedClass=e.class;var t=this.$generatedUrlInput.val(),n=e.class,l=e.element;if("User"===n?this.user=l:this.element=l,this.user&&this.element){var i=this.siteUrl+"elementId="+this.element.id+"&userId="+this.user.id;this.$generatedUrlInput.val(i)}else this.$generatedUrlInput.val(t)}});
