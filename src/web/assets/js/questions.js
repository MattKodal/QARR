var AnswerItem;AnswerItem=Garnish.Base.extend({$container:null,$approveBtn:null,$rejectBtn:null,$deleteBtn:null,$statusLabel:null,statusLabelText:null,id:null,questionId:null,init:function(t){this.$container=$(t),this.$approveBtn=this.$container.find(".btn-approve"),this.$rejectBtn=this.$container.find(".btn-reject"),this.$deleteBtn=this.$container.find(".btn-delete"),this.$statusLabel=this.$container.find(".panel-item-status"),this.statusLabelText=this.$statusLabel.find("span"),this.id=this.$container.data("id"),this.questionId=this.$container.data("parent-id"),this.addListener(this.$approveBtn,"click","performAction"),this.addListener(this.$rejectBtn,"click","performAction"),this.addListener(this.$deleteBtn,"click","performAction")},performAction:function(t){var e=this;t.preventDefault();var s=$(t.currentTarget).data("action"),a={id:this.id,action:s};Craft.postActionRequest("qarr/answers/perform-action",a,$.proxy(function(t,s){t.success&&("deleted"!==t.status?(e.updateStatus(t),Craft.cp.displayNotice(Craft.t("qarr","Answer status changed"))):(e.$container.velocity("slideUp",{duration:300}),Craft.cp.displayNotice(Craft.t("qarr","Answer deleted"))))},this))},updateStatus:function(t){var e=this,s=this.statusLabelText.text();this.statusLabelText.velocity("transition.fadeOut",{duration:350,complete:function(){e.statusLabelText.html(t.status),e.$statusLabel.removeClass("status-"+s),e.$statusLabel.addClass("status-"+t.status),e.statusLabelText.velocity("transition.fadeIn",{duration:100})}})}}),Garnish.$doc.ready(function(){if($("#reply-email-btn").length>0)new QarrEmailCorrespondence("#reply-email-btn");tippy(".tippy",{theme:"light"});$(".abuse-reported-meta .btns").on("click",function(t){t.preventDefault();var e={id:$(this).data("entry-id"),type:$(this).data("type")};Craft.postActionRequest("qarr/elements/clear-abuse",e,$.proxy(function(t,e){t.success&&(Craft.cp.displayNotice(Craft.t("qarr","Abuse cleared")),$(".abuse-reported-meta").velocity({opacity:0},500,function(){$(".abuse-reported-meta").remove()}))},this))}),$(".update-status-btn").on("click",function(t){t.preventDefault();var e={id:$(this).data("element-id"),status:$(this).data("status"),type:$(this).data("type")};Craft.postActionRequest("qarr/elements/update-status",e,$.proxy(function(t,e){t.success&&(Craft.cp.displayNotice(Craft.t("qarr","Status updated")),"approved"===t.entry.status&&($(".status-badge").removeClass("status-pending"),$(".status-badge").removeClass("status-rejected")),"rejected"===t.entry.status&&($(".status-badge").removeClass("status-pending"),$(".status-badge").removeClass("status-approved")),$(".status-badge").addClass("status-"+t.entry.status),$(".status-badge").find("span").html(t.entry.status))},this))}),$(".delete-entry").on("click",function(t){t.preventDefault();var e={id:$(this).data("element-id"),type:$(this).data("type")},s=Craft.t("qarr","Deleting this question will also remove all its answers and correspondence?");new QarrPrompt(s,null).on("response",function(t){var s=this;"ok"===t.response&&Craft.postActionRequest("qarr/questions/delete",e,$.proxy(function(t,e){t.success&&setTimeout($.proxy(function(){Craft.cp.displayNotice(Craft.t("qarr","Entry deleted, redirecting...")),setTimeout($.proxy(function(){Craft.redirectTo(Craft.getCpUrl()+"/qarr/reviews")},this),1e3)},s),1e3)},this))})}),$.each($(".answer-item"),function(t,e){new AnswerItem(e)})});
